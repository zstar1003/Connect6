# ğŸ” å®¢æˆ·ç«¯æ— æ³•è¿›å…¥æ¸¸æˆ - è°ƒè¯•æŒ‡å—

## é—®é¢˜æè¿°
- ä¸»æœºåˆ›å»ºæˆ¿é—´å¹¶è¿›å…¥æ£‹ç›˜ç•Œé¢ âœ…
- å®¢æˆ·ç«¯åŠ å…¥åè¿æ¥æˆåŠŸ âœ…
- **ä½†æ˜¯å®¢æˆ·ç«¯åœç•™åœ¨ Online Lobby,æ²¡æœ‰è·³è½¬åˆ°æ£‹ç›˜** âŒ

---

## è°ƒè¯•æ­¥éª¤

### ç¬¬ä¸€æ­¥: æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°

#### ä¸»æœºç«¯ (ç¬”è®°æœ¬):

1. æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å° (F12 æˆ– Cmd+Option+I)
2. ç‚¹å‡» "Create Room"
3. ç­‰å¾…å®¢æˆ·ç«¯åŠ å…¥

**æœŸæœ›æ—¥å¿—**:
```
[PeerService] Connecting to LAN server: 192.168.31.21:9000/myapp
My peer ID is: xxxxxxxx
[PeerServer] Client connected
[Host] Received data: { type: 'connected' }
[Host] Client connected, starting game...
[Host] Sent start message
```

#### å®¢æˆ·ç«¯ (æ‰‹æœº):

1. åœ¨æ‰‹æœºæµè§ˆå™¨æ‰“å¼€å¼€å‘è€…å·¥å…·:
   - **Safari (iOS)**:
     - Mac: Safari > å¼€å‘ > [ä½ çš„æ‰‹æœº] > [é¡µé¢]
   - **Chrome (Android)**:
     - chrome://inspect#devices
   - æˆ–è€…ä½¿ç”¨ **Eruda** (åœ¨æ§åˆ¶å°è¿è¡Œ):
     ```javascript
     document.write('<script src="https://cdn.jsdelivr.net/npm/eruda"></script><script>eruda.init();</script>');
     ```

2. è¾“å…¥ Room ID å¹¶ç‚¹å‡» Join

**æœŸæœ›æ—¥å¿—**:
```
Connecting to: xxxxxxxx
Connected!
[Client] Received data: { type: 'start' }
[Client] Starting game...
```

---

## å¯èƒ½çš„é—®é¢˜

### é—®é¢˜ 1: å®¢æˆ·ç«¯æ²¡æ”¶åˆ° 'start' æ¶ˆæ¯

**æ£€æŸ¥ç‚¹**:
- ä¸»æœºæ§åˆ¶å°æ˜¯å¦æ˜¾ç¤º `[Host] Sent start message`?
- å®¢æˆ·ç«¯æ§åˆ¶å°æ˜¯å¦æ˜¾ç¤º `[Client] Received data: ...`?

**å¦‚æœä¸»æœºå‘äº†,å®¢æˆ·ç«¯æ²¡æ”¶åˆ°**:

å¯èƒ½æ˜¯ WebRTC æ•°æ®é€šé“é—®é¢˜ã€‚å°è¯•:

1. **æ£€æŸ¥ç½‘ç»œç¯å¢ƒ**:
   - æŸäº›å…¬å¸/å­¦æ ¡ç½‘ç»œä¼šé˜»æ­¢ WebRTC
   - å°è¯•ä½¿ç”¨æ‰‹æœºçƒ­ç‚¹æµ‹è¯•

2. **æ£€æŸ¥æµè§ˆå™¨**:
   - ç¡®ä¿ä¸¤ç«¯éƒ½ä½¿ç”¨ç°ä»£æµè§ˆå™¨
   - Safari æœ‰æ—¶å¯¹ WebRTC æ”¯æŒæœ‰é™,è¯•è¯• Chrome

3. **æ£€æŸ¥è¿æ¥çŠ¶æ€**:
   åœ¨å®¢æˆ·ç«¯æ§åˆ¶å°è¿è¡Œ:
   ```javascript
   // æŸ¥çœ‹ PeerJS è¿æ¥çŠ¶æ€
   console.log('Connection state:', window.peer);
   ```

---

### é—®é¢˜ 2: è¿æ¥å»ºç«‹é¡ºåºé—®é¢˜

**ç—‡çŠ¶**:
- ä¸»æœºæ²¡çœ‹åˆ° `[Host] Received data: { type: 'connected' }`
- è¯´æ˜å®¢æˆ·ç«¯çš„æ¡æ‰‹æ¶ˆæ¯æ²¡åˆ°è¾¾ä¸»æœº

**åŸå› **:
å¯èƒ½æ˜¯è¿æ¥å»ºç«‹æ—¶åºé—®é¢˜,å®¢æˆ·ç«¯åœ¨è¿æ¥å®Œå…¨æ‰“å¼€å‰å°±å‘é€äº†æ¶ˆæ¯

**è§£å†³æ–¹æ¡ˆ**:

æˆ‘å·²ç»åœ¨ä»£ç ä¸­æ·»åŠ äº†æ—¥å¿—,ç°åœ¨éœ€è¦ä½ æµ‹è¯•:

1. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜
2. ä¸»æœºé‡æ–° `npm start`
3. å®¢æˆ·ç«¯åˆ·æ–°é¡µé¢
4. æŸ¥çœ‹åŒæ–¹æ§åˆ¶å°çš„å®Œæ•´æ—¥å¿—

---

### é—®é¢˜ 3: PeerJS æœåŠ¡å™¨é…ç½®

**æ£€æŸ¥å®¢æˆ·ç«¯æ˜¯å¦æ­£ç¡®è¿æ¥åˆ° PeerJS æœåŠ¡å™¨**:

å®¢æˆ·ç«¯æµè§ˆå™¨æ§åˆ¶å°åº”è¯¥æ˜¾ç¤º:
```
[PeerService] Connecting to LAN server: 192.168.31.21:9000/myapp
```

**å¦‚æœæ˜¾ç¤ºçš„æ˜¯ localhost**:
- å®¢æˆ·ç«¯éœ€è¦é…ç½®ç›¸åŒçš„ `.env.local` (ä½†è¿™ä¸ç°å®)
- æˆ–è€…å®¢æˆ·ç«¯ä½¿ç”¨çš„æ˜¯ç¼–è¯‘åçš„ä»£ç ,æ²¡æœ‰è¯»å–åˆ°ç¯å¢ƒå˜é‡

**è§£å†³**:
å®¢æˆ·ç«¯éœ€è¦è®¿é—®ä¸»æœºçš„æœåŠ¡å™¨,æ‰€ä»¥ä¼šè‡ªåŠ¨ä½¿ç”¨ä¸»æœºçš„é…ç½®ã€‚å¦‚æœæœ‰é—®é¢˜,æ£€æŸ¥:

```bash
# ä¸»æœºç«¯æ£€æŸ¥é…ç½®
cat .env.local | grep VITE_PEER_HOST
# åº”è¯¥æ˜¾ç¤º: VITE_PEER_HOST=192.168.31.21
```

---

## ä¸´æ—¶è§£å†³æ–¹æ¡ˆ - æµ‹è¯•è¿æ¥

åœ¨**å®¢æˆ·ç«¯æµè§ˆå™¨æ§åˆ¶å°**æ‰‹åŠ¨è§¦å‘æ¸¸æˆå¼€å§‹:

```javascript
// æ‰‹åŠ¨è®¾ç½®æ¸¸æˆçŠ¶æ€
localStorage.setItem('forceStart', 'true');
location.reload();
```

å¦‚æœè¿™æ ·èƒ½è¿›å…¥æ¸¸æˆ,è¯´æ˜é—®é¢˜ç¡®å®æ˜¯æ¶ˆæ¯ä¼ é€’ã€‚

---

## å®Œæ•´æµ‹è¯•æµç¨‹

### 1. é‡å¯æœåŠ¡
```bash
# ä¸»æœºç«¯
# Ctrl+C åœæ­¢æœåŠ¡
npm start
```

### 2. ä¸»æœºç«¯æ“ä½œ
```
1. è®¿é—® http://localhost:5173
2. F12 æ‰“å¼€æ§åˆ¶å°
3. ç‚¹å‡» "Online Lobby"
4. ç‚¹å‡» "Create Room"
5. å¤åˆ¶ Room ID
6. è§‚å¯Ÿæ§åˆ¶å°æ—¥å¿—
```

### 3. å®¢æˆ·ç«¯æ“ä½œ
```
1. æ‰‹æœºè®¿é—® http://192.168.31.21:5173
2. å¯ç”¨å¼€å‘è€…å·¥å…· (è§ä¸Šæ–‡)
3. ç‚¹å‡» "Online Lobby"
4. ç²˜è´´ Room ID
5. ç‚¹å‡» "Join"
6. è§‚å¯Ÿæ§åˆ¶å°æ—¥å¿—
```

### 4. è®°å½•æ—¥å¿—

**ä¸»æœºç«¯çœ‹åˆ°çš„**:
```
// ç²˜è´´å®Œæ•´æ—¥å¿—
```

**å®¢æˆ·ç«¯çœ‹åˆ°çš„**:
```
// ç²˜è´´å®Œæ•´æ—¥å¿—
```

---

## æ‰‹æœºæµè§ˆå™¨å¼€å¯è°ƒè¯•

### iPhone (Safari):

1. **æ‰‹æœºè®¾ç½®**:
   - è®¾ç½® > Safari > é«˜çº§ > æ‰“å¼€ "Web æ£€æŸ¥å™¨"

2. **Mac ç”µè„‘**:
   - æ‰“å¼€ Safari
   - èœå•æ : Safari > è®¾ç½® > é«˜çº§
   - å‹¾é€‰ "åœ¨èœå•æ ä¸­æ˜¾ç¤ºå¼€å‘èœå•"
   - æ‰‹æœºç”¨ USB è¿æ¥åˆ° Mac
   - Safari èœå•: å¼€å‘ > [ä½ çš„ iPhone] > [ç½‘é¡µ]

### Android (Chrome):

1. **æ‰‹æœºè®¾ç½®**:
   - è®¾ç½® > å¼€å‘è€…é€‰é¡¹ > æ‰“å¼€ "USB è°ƒè¯•"

2. **ç”µè„‘**:
   - Chrome è®¿é—®: `chrome://inspect#devices`
   - ç”¨ USB è¿æ¥æ‰‹æœº
   - ç‚¹å‡» "inspect" æŸ¥çœ‹æ§åˆ¶å°

### æˆ–è€…ä½¿ç”¨ Eruda (æœ€ç®€å•):

åœ¨å®¢æˆ·ç«¯æµè§ˆå™¨åœ°å€æ è¾“å…¥:
```javascript
javascript:(function(){document.write('<script src="https://cdn.jsdelivr.net/npm/eruda"></script><script>eruda.init();</script>');})();
```

ç„¶ååˆ·æ–°é¡µé¢,å³ä¸‹è§’ä¼šå‡ºç°ä¸€ä¸ªè°ƒè¯•æŒ‰é’®ã€‚

---

## é¢„æœŸçš„å®Œæ•´æ—¥å¿—åºåˆ—

### ä¸»æœºç«¯:
```
1. [PeerService] Connecting to LAN server: 192.168.31.21:9000/myapp
2. My peer ID is: abc123def456
3. (ç­‰å¾…å®¢æˆ·ç«¯åŠ å…¥...)
4. [PeerServer] Client connected: xyz789ghi012
5. [Host] Received data: { type: 'connected' }
6. [Host] Client connected, starting game...
7. [Host] Sent start message
```

### å®¢æˆ·ç«¯:
```
1. [PeerService] Connecting to LAN server: 192.168.31.21:9000/myapp
2. My peer ID is: xyz789ghi012
3. Connecting to: abc123def456
4. Connected!
5. [Client] Received data: { type: 'start' }
6. [Client] Starting game...
```

å¦‚æœæ—¥å¿—å’Œä¸Šé¢ä¸ä¸€è‡´,å‘Šè¯‰æˆ‘å…·ä½“æ˜¯å“ªä¸€æ­¥ä¸å¯¹,æˆ‘å¯ä»¥ç²¾å‡†å®šä½é—®é¢˜!

---

## å¿«é€Ÿæµ‹è¯•è„šæœ¬

åœ¨**å®¢æˆ·ç«¯æ§åˆ¶å°**è¿è¡Œ:

```javascript
// ç›‘å¬æ‰€æœ‰æ¶ˆæ¯
const originalLog = console.log;
console.log = function(...args) {
  originalLog.apply(console, ['[INTERCEPTED]', ...args]);
  if (args[0] && args[0].type) {
    alert('Received: ' + args[0].type);
  }
};
```

è¿™æ ·æ¯æ¬¡æ”¶åˆ°æ¶ˆæ¯éƒ½ä¼šå¼¹çª—æç¤º,æ–¹ä¾¿æ‰‹æœºè°ƒè¯•ã€‚

---

æŠŠæµ‹è¯•ç»“æœ(ç‰¹åˆ«æ˜¯æ§åˆ¶å°æ—¥å¿—)å‘ç»™æˆ‘,æˆ‘å¯ä»¥å¸®ä½ ç²¾å‡†å®šä½é—®é¢˜! ğŸ”
